
$(document).ready(function () {

    var c = $("#search-input"),

        d = $("#url-result"),
        g = $("#cursor"),
        a = $(".preview-search-link");
    d.attr("value", window.location);
    d.mouseup(function () {
        this.select()
    });
    d.focus(function () {
        this.select()
    });

    function b(i) {
        if (document.cookie.length > 0) {
            c_start = document.cookie.indexOf(i + "=");
            if (c_start != -1) {
                c_start = c_start + i.length + 1;
                c_end = document.cookie.indexOf(";", c_start);
                if (c_end == -1) {
                    c_end = document.cookie.length
                }
                return unescape(document.cookie.substring(c_start, c_end))
            }
        }
        return ""
    }
    if (b("theme") == "dark") {
        $("body").addClass("dark-theme").removeClass("light-theme");
        $("#ddg-logo").attr("src", "img/ddg-logo-dark-theme.png");
        $("#ddg-theme-url-param").attr("value", "d")
    } else {
        if (b("theme") == "light") {
            $("body").addClass("light-theme").removeClass("dark-theme");
            $("#ddg-logo").attr("src", "img/ddg-logo-light-theme.png");
            $("#ddg-theme-url-param").attr("value", "-1")
        }
    }
    if (window.location.search == "") {
        d.attr("value", window.location.protocol + "//" + window.location.host + window.location.pathname + window.location.search);

        document.getElementById("instructions2").innerHTML = "Type a question & click a Button";
        $("#search-form").submit(function (i) {
            i.preventDefault();
            i.stopPropagation();
            //blank out so page doesn't preview search automatically
            //   window.location = d.attr("value");

            document.getElementById("instructions2").innerHTML = "All Done! Share the link Or Preview";
            document.getElementById("url-output").style.display = "block";
            document.getElementById("addthisbuttons").style.display = "block";
            document.getElementById("copybutton").style.display = "block";
            return false
        });
        c.keyup(function (j) {
            var i = $("#search-input").val();
            $(this).attr("value", $(this).val());
            d.attr("value", window.location.protocol + "//" + window.location.host + window.location.pathname + "?q=" + encodeURIComponent(i));
            a.attr("href", window.location.protocol + "//" + window.location.host + window.location.pathname + "?q=" + encodeURIComponent(i));


        })
        //The reason your autocomplete is not getting shortened is because the 'keyup' event is only being listened for on the input element. The autocomplete selection doesn't trigger this event, so the value change is not being caught by your function. You should also listen for an 'autocomplete select' event or a similar event that your autocomplete  provides.
        c.autocomplete({
            select: function(event, ui) {
                var i = ui.item.value;
                $(this).attr("value", i);
                d.attr("value", window.location.protocol + "//" + window.location.host + window.location.pathname + "?q=" + encodeURIComponent(i));
                a.attr("href", window.location.protocol + "//" + window.location.host + window.location.pathname + "?q=" + encodeURIComponent(i));
            }
        });
    }
    else {
        GoSearch();

        var e = window.location.search;
        var f = e.split("&");
        var h = decodeURIComponent(f[0]);
        if (h.substr(0, 3) == "?q=") {


            h = h.substr(3);
            h = h.replace(/(\S)\+(\S)/g, "$1 $2");


        }
        if (h.length > 0) {
            g.show();
            g.attr("src", "/img/cursor-default.png");
            d.text(window.location.protocol + "//" + window.location.host + window.location.pathname + window.location.search);
            d.attr("href", window.location.protocol + "//" + window.location.host + window.location.pathname + window.location.search);
            if ($("body").width() > 650) {
                g.animate({
                    top: "20px",
                    left: "100px"
                }, 2250);

                document.getElementById("url-output").style.display = "none";
                document.getElementById("addthisbuttons").style.display = "none";
                document.getElementById("instructions2").innerHTML = "Step 1: Type in your question";
                setTimeout(function () {
                    g.attr("src", "/img/cursor-text.png")
                }, 1500);
                c.delay(2250).typetype(h, {
                    callback: function () {
                        g.animate({
                            top: "90px",
                            left: "30%"
                        }, 1200);

                        document.getElementById("instructions2").innerHTML = "Step 2: Click a button";
                        g.attr("src", "/img/cursor-default.png");
                        setTimeout(function () {
                            $("#search-submit").addClass("hovered")

                        }, 800);
                        setTimeout(function () {
                            g.attr("src", "/img/cursor-pointer.png")
                        }, 800);

                        setTimeout(function () {
                            $("#search-submit").trigger("hover");
                            $("#search-submit").addClass("active");


                            document.getElementById("instructions2").innerHTML = "Step 3: Wait 0.21s for results...";
                        }, 1200)
                        setTimeout(function () {

                            var Keywords = document.getElementById("search-input").value;
                            window.location.href = "https://chatgpt.com/?q=" + Keywords;

                        }, 2800)
                    }
                })
            } else {
                if ($("body").width() <= 650) {
                    g.animate({
                        top: "16px",
                        left: "200px"
                    }, 1700);


                    document.getElementById("url-output").style.display = "none";
                    document.getElementById("addthisbuttons").style.display = "none";
                    document.getElementById("instructions2").innerHTML = "Step 1: Type in your question";
                    setTimeout(function () {
                        g.attr("src", "/img/cursor-text.png")
                    }, 1100);
                    c.delay(2000).typetype(h, {
                        callback: function () {
                            g.animate({
                                top: "90px",
                                left: "30%"
                            }, 800);
                            document.getElementById("instructions2").innerHTML = "Step 2: Click the Search button";
                            g.attr("src", "/img/cursor-default.png");
                            setTimeout(function () {
                                $("#search-submit").addClass("hovered")

                            }, 320);
                            setTimeout(function () {
                                g.attr("src", "/img/cursor-pointer.png")
                            }, 320);

                            setTimeout(function () {
                                $("#search-submit").trigger("hover")
                                document.getElementById("instructions2").innerHTML = "Step 3: Wait 0.21s for results...";
                            }, 1000)

                            setTimeout(function () {

                                var Keywords = document.getElementById("search-input").value;
                                window.location.href = "https://chatgpt.com/?q=" + Keywords;

                            }, 2300)
                        }
                    })
                }
            }
        }
    }
    $("#search-form").click(function () {
        $("#search-input").focus()
    });
    $("#shorten-url-result").click(function (i) {
        i.preventDefault();
        i.stopPropagation();
        /// var k = "https://is.gd/create.php?format=json&url=" + encodeURIComponent(d.attr("value")),

        var k = "https://gprivate.com/functions/shorten.php?" + d.attr("value"),
            j;
        if (!j) {
            $.getJSON(k, function (l) {
                j = l.shorturl;
                j = j.replace("http:", "https:");
                d.prop("value", j);

                myShare();
                // myFunction();
            })
        } else {
            d.prop("value", j);

            myShare();
            //  myFunction();
        }
    });
    $("#dark-theme-icon").click(function () {
        $("body").addClass("dark-theme").removeClass("light-theme");
        $("#ddg-logo").attr("src", "img/ddg-logo-dark-theme.png");
        $("#ddg-theme-url-param").attr("value", "d");
        document.cookie = "theme=dark; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/;"
    });
    $("#light-theme-icon").click(function () {
        $("body").addClass("light-theme").removeClass("dark-theme");
        $("#ddg-logo").attr("src", "img/ddg-logo-light-theme.png");
        $("#ddg-theme-url-param").attr("value", "-1");
        document.cookie = "theme=light; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/;"
    })
});